<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ArdiA Health Labs - Clinical Reasoning Engine Pilot Program Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --bg-card-hover: #222d42;
            --accent-blue: #3b82f6;
            --accent-blue-light: #60a5fa;
            --accent-cyan: #22d3ee;
            --accent-green: #10b981;
            --accent-yellow: #f59e0b;
            --accent-red: #ef4444;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border: #334155;
            --gradient-blue: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            --gradient-green: linear-gradient(135deg, #10b981 0%, #059669 100%);
            --gradient-red: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient-blue);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .logo-text h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .logo-text span {
            font-size: 0.75rem;
            color: var(--accent-blue-light);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .header-meta {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .live-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid var(--accent-green);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: var(--accent-green);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .timestamp {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        /* Main Container */
        .main-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Section Title */
        .section-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 24px;
            background: var(--gradient-blue);
            border-radius: 2px;
        }

        /* Executive Summary */
        .executive-summary {
            background: linear-gradient(135deg, #1e3a5f 0%, #0f172a 100%);
            border: 1px solid var(--accent-blue);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .summary-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 2rem;
        }

        .summary-header h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
        }

        .summary-header p {
            color: var(--text-secondary);
        }

        .pilot-badge {
            background: var(--gradient-blue);
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            text-align: center;
        }

        .pilot-badge .label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.8;
        }

        .pilot-badge .duration {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
        }

        /* KPI Grid */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1rem;
        }

        .kpi-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.25rem;
            text-align: center;
            border: 1px solid transparent;
            transition: all 0.3s;
        }

        .kpi-card:hover {
            border-color: var(--accent-blue);
            transform: translateY(-2px);
        }

        .kpi-card.highlight {
            background: rgba(16, 185, 129, 0.1);
            border-color: var(--accent-green);
        }

        .kpi-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .kpi-value {
            font-family: 'Montserrat', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .kpi-value.positive { color: var(--accent-green); }
        .kpi-value.negative { color: var(--accent-red); }
        .kpi-value.currency { color: var(--accent-cyan); }

        .kpi-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 0.5rem;
        }

        .kpi-change {
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        .kpi-change.up { color: var(--accent-green); }
        .kpi-change.down { color: var(--accent-red); }

        /* Clinics Section */
        .clinics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .clinic-card {
            background: var(--bg-card);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .clinic-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .clinic-info h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.125rem;
            margin-bottom: 0.25rem;
        }

        .clinic-info p {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .clinic-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(16, 185, 129, 0.1);
            border-radius: 20px;
            font-size: 0.875rem;
            color: var(--accent-green);
        }

        .clinic-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            padding: 1rem;
            background: rgba(0, 0, 0, 0.2);
        }

        .clinic-stat {
            text-align: center;
            padding: 0.5rem;
        }

        .clinic-stat-value {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.25rem;
            font-weight: 700;
        }

        .clinic-stat-label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        /* Patient Cards */
        .patients-section {
            margin-bottom: 2rem;
        }

        .patients-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }

        .patient-card {
            background: var(--bg-card);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid var(--border);
            transition: all 0.3s;
        }

        .patient-card:hover {
            border-color: var(--accent-blue);
            box-shadow: 0 8px 32px rgba(59, 130, 246, 0.15);
        }

        .patient-header {
            padding: 1.25rem;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            border-bottom: 1px solid var(--border);
        }

        .patient-avatar {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-right: 1rem;
        }

        .patient-avatar.asthma { background: linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%); }
        .patient-avatar.ckd { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .patient-avatar.copd { background: linear-gradient(135deg, #22d3ee 0%, #0891b2 100%); }

        .patient-info {
            flex: 1;
        }

        .patient-name {
            font-family: 'Montserrat', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .patient-meta {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .patient-condition {
            padding: 0.35rem 0.75rem;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .patient-condition.asthma { background: rgba(139, 92, 246, 0.2); color: #a78bfa; }
        .patient-condition.ckd { background: rgba(245, 158, 11, 0.2); color: #fbbf24; }
        .patient-condition.copd { background: rgba(34, 211, 238, 0.2); color: #67e8f9; }

        .patient-status {
            padding: 1.25rem;
            border-bottom: 1px solid var(--border);
        }

        .status-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .status-row:last-child { margin-bottom: 0; }

        .status-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .status-value {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-badge {
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .status-badge.stable { background: rgba(16, 185, 129, 0.2); color: var(--accent-green); }
        .status-badge.attention { background: rgba(245, 158, 11, 0.2); color: var(--accent-yellow); }
        .status-badge.critical { background: rgba(239, 68, 68, 0.2); color: var(--accent-red); }

        /* Reasoning Panel */
        .reasoning-panel {
            padding: 1.25rem;
            background: rgba(59, 130, 246, 0.05);
            border-left: 3px solid var(--accent-blue);
        }

        .reasoning-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
            color: var(--accent-blue-light);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.75rem;
        }

        .reasoning-content {
            font-size: 0.875rem;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .reasoning-action {
            margin-top: 1rem;
            padding: 0.75rem;
            background: rgba(16, 185, 129, 0.1);
            border-radius: 8px;
            border: 1px solid var(--accent-green);
        }

        .reasoning-action-label {
            font-size: 0.7rem;
            color: var(--accent-green);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.25rem;
        }

        .reasoning-action-text {
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Outcomes Section */
        .outcomes-section {
            margin-bottom: 2rem;
        }

        .outcomes-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }

        .outcome-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid var(--border);
        }

        .outcome-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .outcome-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .outcome-icon.prevented { background: var(--gradient-green); }
        .outcome-icon.cost { background: linear-gradient(135deg, #22d3ee 0%, #0891b2 100%); }
        .outcome-icon.engagement { background: linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%); }

        .outcome-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 1rem;
            font-weight: 600;
        }

        .outcome-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .outcome-metric {
            text-align: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
        }

        .outcome-metric-value {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .outcome-metric-label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        /* Timeline */
        .timeline-section {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid var(--border);
        }

        .timeline {
            position: relative;
            padding-left: 2rem;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, var(--accent-blue), var(--accent-green));
        }

        .timeline-item {
            position: relative;
            padding-bottom: 1.5rem;
        }

        .timeline-item:last-child { padding-bottom: 0; }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -2rem;
            top: 0.25rem;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--accent-blue);
            border: 2px solid var(--bg-card);
        }

        .timeline-date {
            font-size: 0.75rem;
            color: var(--accent-blue-light);
            margin-bottom: 0.25rem;
        }

        .timeline-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .timeline-desc {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        /* Footer */
        .footer {
            margin-top: 3rem;
            padding: 3rem 2rem;
            background: linear-gradient(180deg, var(--bg-secondary) 0%, #0d1117 100%);
            border-top: 1px solid var(--border);
            text-align: center;
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .footer-logo {
            font-family: 'Montserrat', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .footer-tagline {
            color: var(--accent-blue-light);
            margin-bottom: 2rem;
            font-size: 1rem;
            font-weight: 500;
        }

        .footer-contact-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem 2rem;
            display: inline-block;
        }

        .footer-name {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .footer-title {
            color: var(--accent-blue-light);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .footer-contact-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1.5rem;
            flex-wrap: wrap;
        }

        .footer-contact-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.875rem;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-contact-item:hover {
            color: var(--accent-blue-light);
        }

        .footer-contact-item svg {
            width: 16px;
            height: 16px;
            stroke: var(--accent-blue);
        }

        .footer-divider {
            color: var(--border);
        }

        /* Print Styles */
        @media print {
            body { background: white; color: black; }
            .header { position: relative; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">üß†</div>
                <div class="logo-text">
                    <h1>ArdiA Health Labs</h1>
                    <span>Clinical Reasoning Engine</span>
                </div>
            </div>
            <div class="header-meta">
                <div class="live-indicator">
                    <span class="live-dot"></span>
                    <span>Pilot Program Active</span>
                </div>
                <div class="timestamp">Last Updated: December 30, 2025 | 14:15 CST</div>
            </div>
        </div>
    </header>

    <main class="main-container">
        <!-- Executive Summary -->
        <section class="executive-summary">
            <div class="summary-header">
                <div>
                    <h2>Pilot Program Executive Summary</h2>
                    <p>Clinical Reasoning Engine Performance Across Partner Clinics</p>
                </div>
                <div class="pilot-badge">
                    <div class="label">Pilot Duration</div>
                    <div class="duration">90 Days</div>
                </div>
            </div>
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-icon">üë•</div>
                    <div class="kpi-value">3</div>
                    <div class="kpi-label">Active Patients</div>
                    <div class="kpi-change up">100% Enrolled</div>
                </div>
                <div class="kpi-card highlight">
                    <div class="kpi-icon">üö®</div>
                    <div class="kpi-value positive">-74%</div>
                    <div class="kpi-label">ER Visit Reduction</div>
                    <div class="kpi-change up">vs. Prior Year</div>
                </div>
                <div class="kpi-card highlight">
                    <div class="kpi-icon">üè•</div>
                    <div class="kpi-value positive">-100%</div>
                    <div class="kpi-label">Hospitalizations</div>
                    <div class="kpi-change up">Zero in Pilot Period</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üí∞</div>
                    <div class="kpi-value currency">$29,790</div>
                    <div class="kpi-label">Cost Savings</div>
                    <div class="kpi-change up">Avoided ER/Hospital</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-icon">üìà</div>
                    <div class="kpi-value currency">$1,650</div>
                    <div class="kpi-label">Revenue Generated</div>
                    <div class="kpi-change up">CCM/RTM Billing</div>
                </div>
            </div>
        </section>

        <!-- Participating Clinics -->
        <h2 class="section-title">Participating Clinics</h2>
        <div class="clinics-grid">
            <div class="clinic-card">
                <div class="clinic-header">
                    <div class="clinic-info">
                        <h3>üè• North Texas Pulmonary & Allergy Associates</h3>
                        <p>Denton, TX 76201 | Dr. Sarah Mitchell, MD</p>
                    </div>
                    <div class="clinic-status">
                        <span class="live-dot"></span>
                        Active
                    </div>
                </div>
                <div class="clinic-stats">
                    <div class="clinic-stat">
                        <div class="clinic-stat-value">2</div>
                        <div class="clinic-stat-label">Patients</div>
                    </div>
                    <div class="clinic-stat">
                        <div class="clinic-stat-value" style="color: var(--accent-green)">94%</div>
                        <div class="clinic-stat-label">Compliance</div>
                    </div>
                    <div class="clinic-stat">
                        <div class="clinic-stat-value" style="color: var(--accent-cyan)">$19,840</div>
                        <div class="clinic-stat-label">Savings</div>
                    </div>
                    <div class="clinic-stat">
                        <div class="clinic-stat-value">23</div>
                        <div class="clinic-stat-label">Interventions</div>
                    </div>
                </div>
            </div>

            <div class="clinic-card">
                <div class="clinic-header">
                    <div class="clinic-info">
                        <h3>üè• Renal Care Specialists of North Texas</h3>
                        <p>Argyle, TX 76226 | Dr. James Rodriguez, MD, FASN</p>
                    </div>
                    <div class="clinic-status">
                        <span class="live-dot"></span>
                        Active
                    </div>
                </div>
                <div class="clinic-stats">
                    <div class="clinic-stat">
                        <div class="clinic-stat-value">1</div>
                        <div class="clinic-stat-label">Patients</div>
                    </div>
                    <div class="clinic-stat">
                        <div class="clinic-stat-value" style="color: var(--accent-green)">98%</div>
                        <div class="clinic-stat-label">Compliance</div>
                    </div>
                    <div class="clinic-stat">
                        <div class="clinic-stat-value" style="color: var(--accent-cyan)">$9,950</div>
                        <div class="clinic-stat-label">Savings</div>
                    </div>
                    <div class="clinic-stat">
                        <div class="clinic-stat-value">12</div>
                        <div class="clinic-stat-label">Interventions</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Patient Cases -->
        <h2 class="section-title">Active Patient Cases - Real-Time Clinical Reasoning</h2>
        <div class="patients-section">
            <div class="patients-grid">
                <!-- Patient 1: Asthma -->
                <div class="patient-card">
                    <div class="patient-header">
                        <div class="patient-avatar asthma">üå¨Ô∏è</div>
                        <div class="patient-info">
                            <div class="patient-name">Maria G., 52</div>
                            <div class="patient-meta">Female | BMI 28.4 | Non-smoker</div>
                        </div>
                        <span class="patient-condition asthma">Severe Asthma</span>
                    </div>
                    <div class="patient-status">
                        <div class="status-row">
                            <span class="status-label">Current Status</span>
                            <span class="status-value">
                                <span class="status-badge stable">STABLE</span>
                            </span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">Peak Flow</span>
                            <span class="status-value">78% predicted</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">SpO2 (Current)</span>
                            <span class="status-value">96%</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">ER Risk Score</span>
                            <span class="status-value" style="color: var(--accent-green)">12% (Low)</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">Prior Year ER Visits</span>
                            <span class="status-value">4 visits</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">Pilot Period ER Visits</span>
                            <span class="status-value" style="color: var(--accent-green)">0 visits ‚úì</span>
                        </div>
                    </div>
                    <div class="reasoning-panel">
                        <div class="reasoning-header">
                            üß† Clinical Reasoning Engine Output
                        </div>
                        <div class="reasoning-content">
                            <strong>Analysis:</strong> Ragweed pollen count is 4.2x Maria's historical trigger threshold (>250 grains/m¬≥). Pattern correlation shows 87% similarity to her September 2024 exacerbation episode. Current peak flow trending down 12% over 3 days.
                        </div>
                        <div class="reasoning-action">
                            <div class="reasoning-action-label">Proactive Intervention Sent</div>
                            <div class="reasoning-action-text">"Start nasal corticosteroid today. Increase controller inhaler to BID. Avoid outdoor activity 2-6 PM. Pattern matches your fall episodes‚Äîacting early prevents ER."</div>
                        </div>
                    </div>
                </div>

                <!-- Patient 2: COPD -->
                <div class="patient-card">
                    <div class="patient-header">
                        <div class="patient-avatar copd">üí®</div>
                        <div class="patient-info">
                            <div class="patient-name">Robert T., 68</div>
                            <div class="patient-meta">Male | BMI 31.2 | Former smoker (40 pk-yrs)</div>
                        </div>
                        <span class="patient-condition copd">COPD Stage III</span>
                    </div>
                    <div class="patient-status">
                        <div class="status-row">
                            <span class="status-label">Current Status</span>
                            <span class="status-value">
                                <span class="status-badge attention">ATTENTION</span>
                            </span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">FEV1</span>
                            <span class="status-value">42% predicted</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">SpO2 (Current)</span>
                            <span class="status-value" style="color: var(--accent-yellow)">91%</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">ER Risk Score</span>
                            <span class="status-value" style="color: var(--accent-yellow)">34% (Moderate)</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">Prior Year ER Visits</span>
                            <span class="status-value">6 visits</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">Pilot Period ER Visits</span>
                            <span class="status-value" style="color: var(--accent-green)">1 visit (‚Üì83%)</span>
                        </div>
                    </div>
                    <div class="reasoning-panel">
                        <div class="reasoning-header">
                            üß† Clinical Reasoning Engine Output
                        </div>
                        <div class="reasoning-content">
                            <strong>Analysis:</strong> SpO2 dropped from 94% baseline to 91% over 48 hours. Voice biomarker analysis detected increased breathiness (+23%) and cough frequency (+4/hour). AQI currently 142 (Unhealthy for Sensitive Groups). Pattern correlates 76% with his January 2025 exacerbation.
                        </div>
                        <div class="reasoning-action">
                            <div class="reasoning-action-label">Proactive Intervention Sent + Provider Alert</div>
                            <div class="reasoning-action-text">"Start rescue prednisone pack per your action plan. Provider Dr. Mitchell notified. Stay indoors‚Äîair quality is poor. If SpO2 drops below 88%, call clinic immediately."</div>
                        </div>
                    </div>
                </div>

                <!-- Patient 3: CKD -->
                <div class="patient-card">
                    <div class="patient-header">
                        <div class="patient-avatar ckd">ü´ò</div>
                        <div class="patient-info">
                            <div class="patient-name">Dorothy W., 71</div>
                            <div class="patient-meta">Female | BMI 26.8 | Diabetic (T2DM)</div>
                        </div>
                        <span class="patient-condition ckd">CKD Stage 3b</span>
                    </div>
                    <div class="patient-status">
                        <div class="status-row">
                            <span class="status-label">Current Status</span>
                            <span class="status-value">
                                <span class="status-badge stable">STABLE</span>
                            </span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">eGFR</span>
                            <span class="status-value">38 mL/min/1.73m¬≤</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">Blood Pressure</span>
                            <span class="status-value">128/78 mmHg</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">Progression Risk</span>
                            <span class="status-value" style="color: var(--accent-green)">Low (Stable 6mo)</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">Prior Year ER Visits</span>
                            <span class="status-value">2 visits</span>
                        </div>
                        <div class="status-row">
                            <span class="status-label">Pilot Period ER Visits</span>
                            <span class="status-value" style="color: var(--accent-green)">0 visits ‚úì</span>
                        </div>
                    </div>
                    <div class="reasoning-panel">
                        <div class="reasoning-header">
                            üß† Clinical Reasoning Engine Output
                        </div>
                        <div class="reasoning-content">
                            <strong>Analysis:</strong> Weight increased 3.2 lbs over 5 days. Dietary sodium intake estimated at 3,200mg/day (goal: <2,000mg). Blood pressure trending up 8% from baseline. Pattern indicates early fluid retention consistent with her February 2025 episode.
                        </div>
                        <div class="reasoning-action">
                            <div class="reasoning-action-label">Proactive Intervention Sent</div>
                            <div class="reasoning-action-text">"Your weight is up 3 lbs this week‚Äîlikely fluid. Reduce sodium today: skip the canned soup, choose fresh. Take your afternoon Lasix. Check weight tomorrow AM. This prevented your ER visit last February."</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Outcomes Grid -->
        <h2 class="section-title">Pilot Program Outcomes</h2>
        <div class="outcomes-section">
            <div class="outcomes-grid">
                <div class="outcome-card">
                    <div class="outcome-header">
                        <div class="outcome-icon prevented">üõ°Ô∏è</div>
                        <div class="outcome-title">Prevented Events</div>
                    </div>
                    <div class="outcome-metrics">
                        <div class="outcome-metric">
                            <div class="outcome-metric-value" style="color: var(--accent-green)">7</div>
                            <div class="outcome-metric-label">ER Visits Prevented</div>
                        </div>
                        <div class="outcome-metric">
                            <div class="outcome-metric-value" style="color: var(--accent-green)">2</div>
                            <div class="outcome-metric-label">Hospitalizations Prevented</div>
                        </div>
                        <div class="outcome-metric">
                            <div class="outcome-metric-value">35</div>
                            <div class="outcome-metric-label">Proactive Interventions</div>
                        </div>
                        <div class="outcome-metric">
                            <div class="outcome-metric-value" style="color: var(--accent-green)">96%</div>
                            <div class="outcome-metric-label">Provider Acceptance</div>
                        </div>
                    </div>
                </div>

                <div class="outcome-card">
                    <div class="outcome-header">
                        <div class="outcome-icon cost">üíµ</div>
                        <div class="outcome-title">Financial Impact</div>
                    </div>
                    <div class="outcome-metrics">
                        <div class="outcome-metric">
                            <div class="outcome-metric-value" style="color: var(--accent-cyan)">$29,790</div>
                            <div class="outcome-metric-label">Total Cost Savings</div>
                        </div>
                        <div class="outcome-metric">
                            <div class="outcome-metric-value" style="color: var(--accent-cyan)">$9,930</div>
                            <div class="outcome-metric-label">Avg. Per Patient</div>
                        </div>
                        <div class="outcome-metric">
                            <div class="outcome-metric-value" style="color: var(--accent-green)">$1,650</div>
                            <div class="outcome-metric-label">CCM/RTM Revenue</div>
                        </div>
                        <div class="outcome-metric">
                            <div class="outcome-metric-value">47:1</div>
                            <div class="outcome-metric-label">ROI Ratio</div>
                        </div>
                    </div>
                </div>

                <div class="outcome-card">
                    <div class="outcome-header">
                        <div class="outcome-icon engagement">üì±</div>
                        <div class="outcome-title">Patient Engagement</div>
                    </div>
                    <div class="outcome-metrics">
                        <div class="outcome-metric">
                            <div class="outcome-metric-value" style="color: var(--accent-purple)">94%</div>
                            <div class="outcome-metric-label">App Engagement Rate</div>
                        </div>
                        <div class="outcome-metric">
                            <div class="outcome-metric-value">2.3</div>
                            <div class="outcome-metric-label">Daily Check-ins Avg.</div>
                        </div>
                        <div class="outcome-metric">
                            <div class="outcome-metric-value" style="color: var(--accent-green)">89%</div>
                            <div class="outcome-metric-label">Recommendation Follow</div>
                        </div>
                        <div class="outcome-metric">
                            <div class="outcome-metric-value">4.8/5</div>
                            <div class="outcome-metric-label">Patient Satisfaction</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Timeline -->
        <h2 class="section-title">Pilot Program Timeline</h2>
        <div class="timeline-section">
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-date">October 1, 2025</div>
                    <div class="timeline-title">Pilot Launch</div>
                    <div class="timeline-desc">Deployed Clinical Reasoning Engine at 2 partner clinics. Onboarded 3 patients with asthma, COPD, and CKD.</div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-date">October 15, 2025</div>
                    <div class="timeline-title">First Intervention Success</div>
                    <div class="timeline-desc">Maria G. (asthma) - Engine detected pollen spike correlation, sent proactive steroid recommendation. Prevented likely ER visit.</div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-date">November 8, 2025</div>
                    <div class="timeline-title">COPD Exacerbation Prevention</div>
                    <div class="timeline-desc">Robert T. - Voice biomarker + SpO2 correlation detected early exacerbation. Prednisone initiated 72 hours before typical symptom peak.</div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-date">November 22, 2025</div>
                    <div class="timeline-title">CKD Fluid Management</div>
                    <div class="timeline-desc">Dorothy W. - Weight trend + sodium estimation prevented fluid overload. Patient avoided ER visit matching her February 2025 pattern.</div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-date">December 30, 2025</div>
                    <div class="timeline-title">90-Day Milestone - Today</div>
                    <div class="timeline-desc">74% ER reduction achieved. Zero hospitalizations. 96% provider acceptance. Preparing for Phase 2 expansion to 10 clinics.</div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">ArdiA Health Labs</div>
            <div class="footer-tagline">From Alerting to Solving | Clinical Intelligence Engine</div>
            <div class="footer-contact-card">
                <div class="footer-name">Ram Vadlamudi</div>
                <div class="footer-title">Founder</div>
                <div class="footer-contact-row">
                    <a href="mailto:ram.vadlamudi@ardiahealthlabs.com" class="footer-contact-item">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
                        ram.vadlamudi@ardiahealthlabs.com
                    </a>
                    <span class="footer-divider">|</span>
                    <a href="tel:+14696793334" class="footer-contact-item">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                        +1 (469) 679-3334
                    </a>
                    <span class="footer-divider">|</span>
                    <a href="https://ardiahealthlabs.com" target="_blank" class="footer-contact-item">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/><path d="M2 12h20"/></svg>
                        ardiahealthlabs.com
                    </a>
                </div>
            </div>
        </div>
    </footer>

<script>
/**
 * Iframe ÂÖÉÁ¥†È´ò‰∫ÆÊ≥®ÂÖ•ËÑöÊú¨
 * ÈúÄË¶ÅÂú®ÁõÆÊ†áÁΩëÁ´ô‰∏≠ÂºïÂÖ•Ê≠§ËÑöÊú¨Êù•ÊîØÊåÅË∑®Âüü iframe È´ò‰∫ÆÂäüËÉΩ
 *
 * ‰ΩøÁî®ÊñπÊ≥ïÔºö
 * 1. Â∞ÜÊ≠§ËÑöÊú¨Ê∑ªÂä†Âà∞ÁõÆÊ†áÁΩëÁ´ôÁöÑ HTML ‰∏≠
 * 2. ÊàñÈÄöËøáÊµèËßàÂô®Êâ©Â±ï„ÄÅÁî®Êà∑ËÑöÊú¨Á≠âÊñπÂºèÊ≥®ÂÖ•
 */

(function () {
  "use strict";

  // Ê£ÄÊü•ÊòØÂê¶Âú® iframe ‰∏≠
  if (window.self === window.top) {
    return; // ‰∏çÂú® iframe ‰∏≠Ôºå‰∏çÊâßË°å
  }

  // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÂàùÂßãÂåñËøá
  if (window.__iframeHighlightInitialized) {
    return;
  }
  window.__iframeHighlightInitialized = true;
  console.log("Iframe È´ò‰∫ÆËÑöÊú¨Â∑≤Âä†ËΩΩ");

  // ÂàõÂª∫È´ò‰∫ÆË¶ÜÁõñÂ±Ç
  var overlay = document.createElement("div");
  overlay.id = "iframe-highlight-overlay";
  overlay.style.cssText = "\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    pointer-events: none;\n    z-index: 999999;\n    overflow: hidden;\n  ";

  // ÂàõÂª∫ÊÇ¨ÂÅúÈ´ò‰∫ÆÊ°ÜÔºàËôöÁ∫øËæπÊ°ÜÔºâ
  var highlightBox = document.createElement("div");
  highlightBox.id = "iframe-highlight-box";
  highlightBox.style.cssText = "\n    position: absolute;\n    border: 2px dashed #007AFF;\n    background: rgba(0, 122, 255, 0.08);\n    pointer-events: none;\n    display: none;\n    transition: all 0.1s ease;\n    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.8);\n    border-radius: 2px;\n  ";

  // ÂàõÂª∫ÈÄâ‰∏≠ËäÇÁÇπÁöÑÂ∏∏È©ªÈ´ò‰∫ÆÊ°ÜÔºàÂÆûÁ∫øËæπÊ°ÜÔºâ
  var selectedBox = document.createElement("div");
  selectedBox.id = "iframe-selected-box";
  selectedBox.style.cssText = "\n    position: absolute;\n    border: 2px solid #007AFF;\n    pointer-events: none;\n    display: none;\n    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.9), 0 0 8px rgba(255, 107, 53, 0.4);\n    border-radius: 2px;\n    z-index: 1000000;\n  ";

  // ÂàõÂª∫ÊÇ¨ÂÅúÊ†áÁ≠æÊòæÁ§∫
  var tagLabel = document.createElement("div");
  tagLabel.id = "iframe-tag-label";
  tagLabel.style.cssText = "\n    position: absolute;\n    background: #007AFF;\n    color: white;\n    padding: 2px 6px;\n    font-size: 11px;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n    border-radius: 2px;\n    pointer-events: none;\n    display: none;\n    white-space: nowrap;\n    z-index: 1000001;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);\n    font-weight: 500;\n  ";

  // ÂàõÂª∫ÈÄâ‰∏≠ËäÇÁÇπÊ†áÁ≠æ
  var selectedLabel = document.createElement("div");
  selectedLabel.id = "iframe-selected-label";
  selectedLabel.style.cssText = "\n    position: absolute;\n    background: #007AFF;\n    color: white;\n    padding: 3px 8px;\n    font-size: 11px;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n    border-radius: 3px;\n    pointer-events: none;\n    display: none;\n    white-space: nowrap;\n    z-index: 1000002;\n    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);\n    font-weight: 600;\n  ";
  overlay.appendChild(highlightBox);
  overlay.appendChild(selectedBox);
  overlay.appendChild(tagLabel);
  overlay.appendChild(selectedLabel);
  document.body.appendChild(overlay);

  // Â≠òÂÇ®ÂΩìÂâçÈÄâ‰∏≠ÁöÑÂÖÉÁ¥†
  var selectedElement = null;
  var highlightEnabled = false;

  // Êõ¥Êñ∞ÈÄâ‰∏≠ÂÖÉÁ¥†ÁöÑÈ´ò‰∫ÆÊòæÁ§∫
  function updateSelectedHighlight(element) {
    console.log("updateSelectedHighlight called with:", element);
    if (!element) {
      selectedBox.style.display = "none";
      selectedLabel.style.display = "none";
      selectedElement = null;
      console.log("Cleared selected highlight");
      return;
    }
    selectedElement = element;
    var rect = element.getBoundingClientRect();
    console.log("Selected element rect:", rect);

    // Êõ¥Êñ∞ÈÄâ‰∏≠È´ò‰∫ÆÊ°Ü‰ΩçÁΩÆ
    selectedBox.style.display = "block";
    selectedBox.style.left = "".concat(rect.left - 2, "px");
    selectedBox.style.top = "".concat(rect.top - 2, "px");
    selectedBox.style.width = "".concat(rect.width + 4, "px");
    selectedBox.style.height = "".concat(rect.height + 4, "px");

    // Êõ¥Êñ∞ÈÄâ‰∏≠Ê†áÁ≠æ‰ΩçÁΩÆÂíåÂÜÖÂÆπ
    selectedLabel.style.display = "block";
    selectedLabel.textContent = "\u2713 <".concat(element.tagName.toLowerCase(), ">");

    // ËÆ°ÁÆóÊ†áÁ≠æ‰ΩçÁΩÆÔºåÁ°Æ‰øù‰∏çË∂ÖÂá∫ËßÜÁ™ó
    var labelTop = rect.top - 28;
    var labelLeft = rect.left;

    // Â¶ÇÊûúÊ†áÁ≠æ‰ºöË∂ÖÂá∫È°∂ÈÉ®ÔºåÊòæÁ§∫Âú®ÂÖÉÁ¥†‰∏ãÊñπ
    if (labelTop < 5) {
      labelTop = rect.bottom + 5;
    }

    // Â¶ÇÊûúÊ†áÁ≠æ‰ºöË∂ÖÂá∫Âè≥‰æßÔºåÂêëÂ∑¶Ë∞ÉÊï¥
    var labelWidth = selectedLabel.offsetWidth || 100; // È¢Ñ‰º∞ÂÆΩÂ∫¶
    if (labelLeft + labelWidth > window.innerWidth - 10) {
      labelLeft = window.innerWidth - labelWidth - 10;
    }
    selectedLabel.style.left = "".concat(Math.max(5, labelLeft), "px");
    selectedLabel.style.top = "".concat(labelTop, "px");
    console.log("Selected highlight positioned at:", {
      left: selectedBox.style.left,
      top: selectedBox.style.top,
      width: selectedBox.style.width,
      height: selectedBox.style.height
    });
  }
  function getElementSelector(element) {
    if (!(element instanceof Element)) throw new Error('Argument must be a DOM element');
    var segments = [];
    var current = element;
    while (current !== document.documentElement) {
      var selector = '';
      // ‰ºòÂÖàÊ£ÄÊü•ÂîØ‰∏ÄID
      if (current.id && document.querySelectorAll("#".concat(current.id)).length === 1) {
        segments.unshift("#".concat(current.id));
        break; // IDÂîØ‰∏ÄÔºåÊó†ÈúÄÁªßÁª≠Âêë‰∏ä
      }

      // ÁîüÊàêÁ±ªÂêçÈÄâÊã©Âô®ÔºàÂèñÁ¨¨‰∏Ä‰∏™ÊúâÊïàÁ±ªÂêçÔºâ
      var classes = Array.from(current.classList).filter(function (c) {
        return !c.startsWith('js-');
      });
      var className = classes.length > 0 ? ".".concat(classes[0]) : '';

      // ÁîüÊàê‰ΩçÁΩÆÁ¥¢ÂºïÔºànth-childÔºâ
      var tag = current.tagName.toLowerCase();
      if (!className) {
        var siblings = Array.from(current.parentNode.children);
        var index = siblings.findIndex(function (el) {
          return el === current;
        }) + 1;
        selector = "".concat(tag, ":nth-child(").concat(index, ")");
      } else {
        selector = className;
      }
      segments.unshift(selector);
      current = current.parentElement;
    }

    // Â§ÑÁêÜÊ†πÂÖÉÁ¥†
    if (current === document.documentElement) {
      segments.unshift('html');
    }
    return segments.join(' > ');
  }

  // Ëé∑ÂèñÂÖÉÁ¥†ÊñáÊú¨ÂÜÖÂÆπ
  function getElementText(element) {
    var _element$textContent;
    if (element.tagName === "INPUT") {
      return element.value || element.placeholder || "";
    }
    if (element.tagName === "TEXTAREA") {
      return element.value || element.placeholder || "";
    }
    var text = ((_element$textContent = element.textContent) === null || _element$textContent === void 0 ? void 0 : _element$textContent.trim()) || "";
    return text.length > 50 ? text.substring(0, 50) + "..." : text;
  }

  // Ëé∑ÂèñÂÖÉÁ¥†Â±ûÊÄß‰ø°ÊÅØ
  function getElementAttributes(element) {
    var attrs = {};
    for (var i = 0; i < element.attributes.length; i++) {
      var attr = element.attributes[i];
      attrs[attr.name] = attr.value;
    }
    return attrs;
  }

  // Èº†Ê†áÊÇ¨ÂÅú‰∫ã‰ª∂Â§ÑÁêÜ
  function handleMouseOver(e) {
    if (!highlightEnabled) return;
    var target = e.target;
    if (!target || target === overlay || target === highlightBox || target === tagLabel || target === selectedBox || target === selectedLabel) {
      return;
    }

    // ÈÅøÂÖçÈ´ò‰∫Æ html Âíå body ÂÖÉÁ¥†
    if (target === document.documentElement || target === document.body) {
      return;
    }

    // Â¶ÇÊûúÊòØÂ∑≤ÈÄâ‰∏≠ÁöÑÂÖÉÁ¥†Ôºå‰∏çÊòæÁ§∫ÊÇ¨ÂÅúÈ´ò‰∫Æ
    if (target === selectedElement) {
      highlightBox.style.display = "none";
      tagLabel.style.display = "none";
      return;
    }
    var rect = target.getBoundingClientRect();
    var selector = getElementSelector(target);
    var text = getElementText(target);
    var attributes = getElementAttributes(target);

    // Êõ¥Êñ∞ÊÇ¨ÂÅúÈ´ò‰∫ÆÊ°Ü‰ΩçÁΩÆ
    highlightBox.style.display = "block";
    highlightBox.style.left = "".concat(rect.left - 2, "px");
    highlightBox.style.top = "".concat(rect.top - 2, "px");
    highlightBox.style.width = "".concat(rect.width + 4, "px");
    highlightBox.style.height = "".concat(rect.height + 4, "px");

    // Êõ¥Êñ∞Ê†áÁ≠æ‰ΩçÁΩÆÂíåÂÜÖÂÆπ
    tagLabel.style.display = "block";
    tagLabel.textContent = "<".concat(target.tagName.toLowerCase(), ">");

    // ËÆ°ÁÆóÊ†áÁ≠æ‰ΩçÁΩÆÔºåÁ°Æ‰øù‰∏çË∂ÖÂá∫ËßÜÁ™ó
    var labelTop = rect.top - 22;
    var labelLeft = rect.left;

    // Â¶ÇÊûúÊ†áÁ≠æ‰ºöË∂ÖÂá∫È°∂ÈÉ®ÔºåÊòæÁ§∫Âú®ÂÖÉÁ¥†‰∏ãÊñπ
    if (labelTop < 0) {
      labelTop = rect.bottom + 5;
    }

    // Â¶ÇÊûúÊ†áÁ≠æ‰ºöË∂ÖÂá∫Âè≥‰æßÔºåÂêëÂ∑¶Ë∞ÉÊï¥
    if (labelLeft + tagLabel.offsetWidth > window.innerWidth) {
      labelLeft = window.innerWidth - tagLabel.offsetWidth - 5;
    }
    tagLabel.style.left = "".concat(Math.max(0, labelLeft), "px");
    tagLabel.style.top = "".concat(labelTop, "px");

    // ÂèëÈÄÅÊ∂àÊÅØÂà∞Áà∂Á™óÂè£
    var elementInfo = {
      tagName: target.tagName.toLowerCase(),
      rect: {
        left: rect.left,
        top: rect.top,
        right: rect.right,
        bottom: rect.bottom,
        width: rect.width,
        height: rect.height,
        x: rect.x,
        y: rect.y
      },
      selector: selector,
      text: text,
      attributes: attributes,
      url: window.location.href,
      path: window.location.pathname,
      timestamp: Date.now()
    };
    try {
      window.parent.postMessage({
        type: "iframe-element-hover",
        data: elementInfo,
        source: "iframe-highlight-injector"
      }, "*");
    } catch (error) {
      console.warn("Êó†Ê≥ïÂèëÈÄÅÊ∂àÊÅØÂà∞Áà∂Á™óÂè£:", error);
    }
  }

  // Èº†Ê†áÁ¶ªÂºÄ‰∫ã‰ª∂Â§ÑÁêÜ
  function handleMouseOut(e) {
    if (!highlightEnabled) return;
    var relatedTarget = e.relatedTarget;

    // Â¶ÇÊûúÈº†Ê†áÁßªÂä®Âà∞È´ò‰∫ÆÁõ∏ÂÖ≥ÂÖÉÁ¥†‰∏äÔºå‰∏çÈöêËóèÈ´ò‰∫Æ
    if (relatedTarget && (relatedTarget === highlightBox || relatedTarget === tagLabel || relatedTarget === overlay || relatedTarget === selectedBox || relatedTarget === selectedLabel)) {
      return;
    }
    highlightBox.style.display = "none";
    tagLabel.style.display = "none";
    try {
      window.parent.postMessage({
        type: "iframe-element-hover",
        data: null,
        source: "iframe-highlight-injector"
      }, "*");
    } catch (error) {
      console.warn("Êó†Ê≥ïÂèëÈÄÅÊ∂àÊÅØÂà∞Áà∂Á™óÂè£:", error);
    }
  }

  // ÁÇπÂáª‰∫ã‰ª∂Â§ÑÁêÜ
  function handleClick(e) {
    var target = e.target;
    if (!target || target === overlay || target === highlightBox || target === tagLabel || target === selectedBox || target === selectedLabel) {
      return;
    }

    // ÈÅøÂÖçÂ§ÑÁêÜ html Âíå body ÂÖÉÁ¥†
    if (target === document.documentElement || target === document.body) {
      return;
    }

    // Ê£ÄÊü•ÊòØÂê¶ÊòØ‰∫§‰∫íÂÖÉÁ¥†ÔºåËøô‰∫õÂÖÉÁ¥†ÈúÄË¶Å‰øùÁïôÈªòËÆ§Ë°å‰∏∫
    var isInteractiveElement = ['input', 'textarea', 'select', 'button', 'a'].includes(target.tagName.toLowerCase());

    // Â¶ÇÊûúÈ´ò‰∫ÆÂäüËÉΩÂêØÁî®ÔºåÂØπ‰∫éÈùû‰∫§‰∫íÂÖÉÁ¥†ÈòªÊ≠¢ÈªòËÆ§Ë°å‰∏∫Âíå‰∫ã‰ª∂‰º†Êí≠
    if (highlightEnabled) {
      e.preventDefault();
      e.stopPropagation();
    }
    var rect = target.getBoundingClientRect();
    var selector = getElementSelector(target);
    var text = getElementText(target);
    var attributes = getElementAttributes(target);
    console.log("Element clicked:", {
      tagName: target.tagName,
      selector: selector,
      rect: rect
    });

    // Á´ãÂç≥Êõ¥Êñ∞ÈÄâ‰∏≠È´ò‰∫Æ
    updateSelectedHighlight(target);

    // ÈöêËóèÊÇ¨ÂÅúÈ´ò‰∫ÆÔºåÂõ†‰∏∫Áé∞Âú®ÊòØÈÄâ‰∏≠Áä∂ÊÄÅ
    highlightBox.style.display = "none";
    tagLabel.style.display = "none";
    var elementInfo = {
      tagName: target.tagName.toLowerCase(),
      rect: {
        left: rect.left,
        top: rect.top,
        right: rect.right,
        bottom: rect.bottom,
        width: rect.width,
        height: rect.height,
        x: rect.x,
        y: rect.y
      },
      selector: selector,
      text: text,
      attributes: attributes,
      url: window.location.href,
      path: window.location.pathname,
      timestamp: Date.now()
    };
    try {
      window.parent.postMessage({
        type: "iframe-element-click",
        data: elementInfo,
        source: "iframe-highlight-injector"
      }, "*");
    } catch (error) {
      console.warn("Êó†Ê≥ïÂèëÈÄÅÊ∂àÊÅØÂà∞Áà∂Á™óÂè£:", error);
    }
  }

  // ÁõëÂê¨Êù•Ëá™Áà∂Á™óÂè£ÁöÑÊ∂àÊÅØ
  function handleParentMessage(event) {
    console.log("Received message from parent:", event.data);
    if (event.data.type === "iframe-highlight-toggle") {
      var enabled = event.data.enabled;
      console.log("Highlight toggle:", enabled);
      if (enabled) {
        enableHighlight();
      } else {
        disableHighlight();
      }
    } else if (event.data.type === "enable-iframe-highlight") {
      console.log("Enable iframe highlight");
      enableHighlight();
    } else if (event.data.type === "disable-iframe-highlight") {
      console.log("Disable iframe highlight");
      disableHighlight();
    } else if (event.data.type === "toggle-iframe-highlight") {
      var _enabled = event.data.enabled !== undefined ? event.data.enabled : !highlightEnabled;
      console.log("Toggle iframe highlight to:", _enabled);
      if (_enabled) {
        enableHighlight();
      } else {
        disableHighlight();
      }
    } else if (event.data.type === "update-selected-element") {
      var selector = event.data.selector;
      console.log("Update selected element with selector:", selector);
      if (selector) {
        try {
          var element = document.querySelector(selector);
          console.log("Found element by selector:", element);
          updateSelectedHighlight(element);
        } catch (error) {
          console.warn("Failed to select element:", error);
          updateSelectedHighlight(null);
        }
      } else {
        updateSelectedHighlight(null);
      }
    } else if (event.data.type === "clear-selected-element") {
      console.log("Clear selected element");
      updateSelectedHighlight(null);
    }
  }

  // ÂêØÁî®È´ò‰∫ÆÂäüËÉΩ
  function enableHighlight() {
    console.log("Enabling highlight");
    document.addEventListener("mouseover", handleMouseOver, true);
    document.addEventListener("mouseout", handleMouseOut, true);
    document.addEventListener("click", handleClick, true);
    highlightEnabled = true;
    overlay.style.display = "block";
  }

  // Á¶ÅÁî®È´ò‰∫ÆÂäüËÉΩ
  function disableHighlight() {
    console.log("Disabling highlight");
    highlightEnabled = false;
    // ‰øùÊåÅ‰∫ã‰ª∂ÁõëÂê¨Âô®Ôºå‰ΩÜÈÄöËøá highlightEnabled ÂèòÈáèÊéßÂà∂Ë°å‰∏∫
    // ËøôÊ†∑ÂèØ‰ª•‰øùÁïôÈÄâ‰∏≠Áä∂ÊÄÅÁöÑÊòæÁ§∫
    highlightBox.style.display = "none";
    tagLabel.style.display = "none";
    // ‰∏çÈöêËóè selectedBox Âíå selectedLabelÔºå‰øùÁïôÈÄâ‰∏≠Áä∂ÊÄÅ
  }

  // ÂÆåÂÖ®Á¶ÅÁî®È´ò‰∫ÆÂäüËÉΩÔºàÁßªÈô§ÊâÄÊúâÁõëÂê¨Âô®Ôºâ
  function fullyDisableHighlight() {
    console.log("Fully disabling highlight");
    highlightEnabled = false;
    document.removeEventListener("mouseover", handleMouseOver, true);
    document.removeEventListener("mouseout", handleMouseOut, true);
    document.removeEventListener("click", handleClick, true);
    overlay.style.display = "none";
    highlightBox.style.display = "none";
    tagLabel.style.display = "none";
    selectedBox.style.display = "none";
    selectedLabel.style.display = "none";
  }

  // Ê∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨
  enableHighlight();
  window.addEventListener("message", handleParentMessage);

  // Êö¥Èú≤ÂÖ®Â±ÄÂáΩÊï∞‰æõÂ§ñÈÉ®Ë∞ÉÁî®
  window.__iframeHighlightControl = {
    enable: enableHighlight,
    disable: disableHighlight,
    fullyDisable: fullyDisableHighlight,
    isEnabled: function isEnabled() {
      return highlightEnabled;
    },
    getSelectedElement: function getSelectedElement() {
      return selectedElement;
    },
    updateSelected: updateSelectedHighlight,
    // ÈÄöËøáÊ∂àÊÅØÂèëÈÄÅÂºÄÂÖ≥ÊéßÂà∂
    sendToggleMessage: function sendToggleMessage(enabled) {
      window.parent.postMessage({
        type: 'iframe-highlight-status',
        enabled: enabled || highlightEnabled,
        source: 'iframe-highlight-injector'
      }, '*');
    }
  };

  // ÈÄöÁü•Áà∂Á™óÂè£ËÑöÊú¨Â∑≤Âä†ËΩΩ
  try {
    window.parent.postMessage({
      type: "iframe-highlight-ready",
      data: {
        url: window.location.href,
        userAgent: navigator.userAgent,
        timestamp: Date.now()
      },
      source: "iframe-highlight-injector"
    }, "*");
  } catch (error) {
    console.warn("Êó†Ê≥ïÂèëÈÄÅÂ∞±Áª™Ê∂àÊÅØÂà∞Áà∂Á™óÂè£:", error);
  }

  // Ê∏ÖÁêÜÂáΩÊï∞
  window.__iframeHighlightCleanup = function () {
    fullyDisableHighlight();
    window.removeEventListener("message", handleParentMessage);
    if (overlay.parentElement) {
      overlay.parentElement.removeChild(overlay);
    }
    delete window.__iframeHighlightInitialized;
    delete window.__iframeHighlightCleanup;
  };
})();

</script>

<script>
/**
 * Iframe ÂÖÉÁ¥†È´ò‰∫ÆÊ≥®ÂÖ•ËÑöÊú¨
 * ÈúÄË¶ÅÂú®ÁõÆÊ†áÁΩëÁ´ô‰∏≠ÂºïÂÖ•Ê≠§ËÑöÊú¨Êù•ÊîØÊåÅË∑®Âüü iframe È´ò‰∫ÆÂäüËÉΩ
 *
 * ‰ΩøÁî®ÊñπÊ≥ïÔºö
 * 1. Â∞ÜÊ≠§ËÑöÊú¨Ê∑ªÂä†Âà∞ÁõÆÊ†áÁΩëÁ´ôÁöÑ HTML ‰∏≠
 * 2. ÊàñÈÄöËøáÊµèËßàÂô®Êâ©Â±ï„ÄÅÁî®Êà∑ËÑöÊú¨Á≠âÊñπÂºèÊ≥®ÂÖ•
 */

(function () {
  "use strict";

  // Ê£ÄÊü•ÊòØÂê¶Âú® iframe ‰∏≠
  if (window.self === window.top) {
    return; // ‰∏çÂú® iframe ‰∏≠Ôºå‰∏çÊâßË°å
  }

  // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÂàùÂßãÂåñËøá
  if (window.__iframeHighlightInitialized) {
    return;
  }
  window.__iframeHighlightInitialized = true;
  console.log("Iframe È´ò‰∫ÆËÑöÊú¨Â∑≤Âä†ËΩΩ");

  // ÂàõÂª∫È´ò‰∫ÆË¶ÜÁõñÂ±Ç
  var overlay = document.createElement("div");
  overlay.id = "iframe-highlight-overlay";
  overlay.style.cssText = "\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    pointer-events: none;\n    z-index: 999999;\n    overflow: hidden;\n  ";

  // ÂàõÂª∫ÊÇ¨ÂÅúÈ´ò‰∫ÆÊ°ÜÔºàËôöÁ∫øËæπÊ°ÜÔºâ
  var highlightBox = document.createElement("div");
  highlightBox.id = "iframe-highlight-box";
  highlightBox.style.cssText = "\n    position: absolute;\n    border: 2px dashed #007AFF;\n    background: rgba(0, 122, 255, 0.08);\n    pointer-events: none;\n    display: none;\n    transition: all 0.1s ease;\n    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.8);\n    border-radius: 2px;\n  ";

  // ÂàõÂª∫ÈÄâ‰∏≠ËäÇÁÇπÁöÑÂ∏∏È©ªÈ´ò‰∫ÆÊ°ÜÔºàÂÆûÁ∫øËæπÊ°ÜÔºâ
  var selectedBox = document.createElement("div");
  selectedBox.id = "iframe-selected-box";
  selectedBox.style.cssText = "\n    position: absolute;\n    border: 2px solid #007AFF;\n    pointer-events: none;\n    display: none;\n    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.9), 0 0 8px rgba(255, 107, 53, 0.4);\n    border-radius: 2px;\n    z-index: 1000000;\n  ";

  // ÂàõÂª∫ÊÇ¨ÂÅúÊ†áÁ≠æÊòæÁ§∫
  var tagLabel = document.createElement("div");
  tagLabel.id = "iframe-tag-label";
  tagLabel.style.cssText = "\n    position: absolute;\n    background: #007AFF;\n    color: white;\n    padding: 2px 6px;\n    font-size: 11px;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n    border-radius: 2px;\n    pointer-events: none;\n    display: none;\n    white-space: nowrap;\n    z-index: 1000001;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);\n    font-weight: 500;\n  ";

  // ÂàõÂª∫ÈÄâ‰∏≠ËäÇÁÇπÊ†áÁ≠æ
  var selectedLabel = document.createElement("div");
  selectedLabel.id = "iframe-selected-label";
  selectedLabel.style.cssText = "\n    position: absolute;\n    background: #007AFF;\n    color: white;\n    padding: 3px 8px;\n    font-size: 11px;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n    border-radius: 3px;\n    pointer-events: none;\n    display: none;\n    white-space: nowrap;\n    z-index: 1000002;\n    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);\n    font-weight: 600;\n  ";
  overlay.appendChild(highlightBox);
  overlay.appendChild(selectedBox);
  overlay.appendChild(tagLabel);
  overlay.appendChild(selectedLabel);
  document.body.appendChild(overlay);

  // Â≠òÂÇ®ÂΩìÂâçÈÄâ‰∏≠ÁöÑÂÖÉÁ¥†
  var selectedElement = null;
  var highlightEnabled = false;

  // Êõ¥Êñ∞ÈÄâ‰∏≠ÂÖÉÁ¥†ÁöÑÈ´ò‰∫ÆÊòæÁ§∫
  function updateSelectedHighlight(element) {
    console.log("updateSelectedHighlight called with:", element);
    if (!element) {
      selectedBox.style.display = "none";
      selectedLabel.style.display = "none";
      selectedElement = null;
      console.log("Cleared selected highlight");
      return;
    }
    selectedElement = element;
    var rect = element.getBoundingClientRect();
    console.log("Selected element rect:", rect);

    // Êõ¥Êñ∞ÈÄâ‰∏≠È´ò‰∫ÆÊ°Ü‰ΩçÁΩÆ
    selectedBox.style.display = "block";
    selectedBox.style.left = "".concat(rect.left - 2, "px");
    selectedBox.style.top = "".concat(rect.top - 2, "px");
    selectedBox.style.width = "".concat(rect.width + 4, "px");
    selectedBox.style.height = "".concat(rect.height + 4, "px");

    // Êõ¥Êñ∞ÈÄâ‰∏≠Ê†áÁ≠æ‰ΩçÁΩÆÂíåÂÜÖÂÆπ
    selectedLabel.style.display = "block";
    selectedLabel.textContent = "\u2713 <".concat(element.tagName.toLowerCase(), ">");

    // ËÆ°ÁÆóÊ†áÁ≠æ‰ΩçÁΩÆÔºåÁ°Æ‰øù‰∏çË∂ÖÂá∫ËßÜÁ™ó
    var labelTop = rect.top - 28;
    var labelLeft = rect.left;

    // Â¶ÇÊûúÊ†áÁ≠æ‰ºöË∂ÖÂá∫È°∂ÈÉ®ÔºåÊòæÁ§∫Âú®ÂÖÉÁ¥†‰∏ãÊñπ
    if (labelTop < 5) {
      labelTop = rect.bottom + 5;
    }

    // Â¶ÇÊûúÊ†áÁ≠æ‰ºöË∂ÖÂá∫Âè≥‰æßÔºåÂêëÂ∑¶Ë∞ÉÊï¥
    var labelWidth = selectedLabel.offsetWidth || 100; // È¢Ñ‰º∞ÂÆΩÂ∫¶
    if (labelLeft + labelWidth > window.innerWidth - 10) {
      labelLeft = window.innerWidth - labelWidth - 10;
    }
    selectedLabel.style.left = "".concat(Math.max(5, labelLeft), "px");
    selectedLabel.style.top = "".concat(labelTop, "px");
    console.log("Selected highlight positioned at:", {
      left: selectedBox.style.left,
      top: selectedBox.style.top,
      width: selectedBox.style.width,
      height: selectedBox.style.height
    });
  }
  function getElementSelector(element) {
    if (!(element instanceof Element)) throw new Error('Argument must be a DOM element');
    var segments = [];
    var current = element;
    while (current !== document.documentElement) {
      var selector = '';
      // ‰ºòÂÖàÊ£ÄÊü•ÂîØ‰∏ÄID
      if (current.id && document.querySelectorAll("#".concat(current.id)).length === 1) {
        segments.unshift("#".concat(current.id));
        break; // IDÂîØ‰∏ÄÔºåÊó†ÈúÄÁªßÁª≠Âêë‰∏ä
      }

      // ÁîüÊàêÁ±ªÂêçÈÄâÊã©Âô®ÔºàÂèñÁ¨¨‰∏Ä‰∏™ÊúâÊïàÁ±ªÂêçÔºâ
      var classes = Array.from(current.classList).filter(function (c) {
        return !c.startsWith('js-');
      });
      var className = classes.length > 0 ? ".".concat(classes[0]) : '';

      // ÁîüÊàê‰ΩçÁΩÆÁ¥¢ÂºïÔºànth-childÔºâ
      var tag = current.tagName.toLowerCase();
      if (!className) {
        var siblings = Array.from(current.parentNode.children);
        var index = siblings.findIndex(function (el) {
          return el === current;
        }) + 1;
        selector = "".concat(tag, ":nth-child(").concat(index, ")");
      } else {
        selector = className;
      }
      segments.unshift(selector);
      current = current.parentElement;
    }

    // Â§ÑÁêÜÊ†πÂÖÉÁ¥†
    if (current === document.documentElement) {
      segments.unshift('html');
    }
    return segments.join(' > ');
  }

  // Ëé∑ÂèñÂÖÉÁ¥†ÊñáÊú¨ÂÜÖÂÆπ
  function getElementText(element) {
    var _element$textContent;
    if (element.tagName === "INPUT") {
      return element.value || element.placeholder || "";
    }
    if (element.tagName === "TEXTAREA") {
      return element.value || element.placeholder || "";
    }
    var text = ((_element$textContent = element.textContent) === null || _element$textContent === void 0 ? void 0 : _element$textContent.trim()) || "";
    return text.length > 50 ? text.substring(0, 50) + "..." : text;
  }

  // Ëé∑ÂèñÂÖÉÁ¥†Â±ûÊÄß‰ø°ÊÅØ
  function getElementAttributes(element) {
    var attrs = {};
    for (var i = 0; i < element.attributes.length; i++) {
      var attr = element.attributes[i];
      attrs[attr.name] = attr.value;
    }
    return attrs;
  }

  // Èº†Ê†áÊÇ¨ÂÅú‰∫ã‰ª∂Â§ÑÁêÜ
  function handleMouseOver(e) {
    if (!highlightEnabled) return;
    var target = e.target;
    if (!target || target === overlay || target === highlightBox || target === tagLabel || target === selectedBox || target === selectedLabel) {
      return;
    }

    // ÈÅøÂÖçÈ´ò‰∫Æ html Âíå body ÂÖÉÁ¥†
    if (target === document.documentElement || target === document.body) {
      return;
    }

    // Â¶ÇÊûúÊòØÂ∑≤ÈÄâ‰∏≠ÁöÑÂÖÉÁ¥†Ôºå‰∏çÊòæÁ§∫ÊÇ¨ÂÅúÈ´ò‰∫Æ
    if (target === selectedElement) {
      highlightBox.style.display = "none";
      tagLabel.style.display = "none";
      return;
    }
    var rect = target.getBoundingClientRect();
    var selector = getElementSelector(target);
    var text = getElementText(target);
    var attributes = getElementAttributes(target);

    // Êõ¥Êñ∞ÊÇ¨ÂÅúÈ´ò‰∫ÆÊ°Ü‰ΩçÁΩÆ
    highlightBox.style.display = "block";
    highlightBox.style.left = "".concat(rect.left - 2, "px");
    highlightBox.style.top = "".concat(rect.top - 2, "px");
    highlightBox.style.width = "".concat(rect.width + 4, "px");
    highlightBox.style.height = "".concat(rect.height + 4, "px");

    // Êõ¥Êñ∞Ê†áÁ≠æ‰ΩçÁΩÆÂíåÂÜÖÂÆπ
    tagLabel.style.display = "block";
    tagLabel.textContent = "<".concat(target.tagName.toLowerCase(), ">");

    // ËÆ°ÁÆóÊ†áÁ≠æ‰ΩçÁΩÆÔºåÁ°Æ‰øù‰∏çË∂ÖÂá∫ËßÜÁ™ó
    var labelTop = rect.top - 22;
    var labelLeft = rect.left;

    // Â¶ÇÊûúÊ†áÁ≠æ‰ºöË∂ÖÂá∫È°∂ÈÉ®ÔºåÊòæÁ§∫Âú®ÂÖÉÁ¥†‰∏ãÊñπ
    if (labelTop < 0) {
      labelTop = rect.bottom + 5;
    }

    // Â¶ÇÊûúÊ†áÁ≠æ‰ºöË∂ÖÂá∫Âè≥‰æßÔºåÂêëÂ∑¶Ë∞ÉÊï¥
    if (labelLeft + tagLabel.offsetWidth > window.innerWidth) {
      labelLeft = window.innerWidth - tagLabel.offsetWidth - 5;
    }
    tagLabel.style.left = "".concat(Math.max(0, labelLeft), "px");
    tagLabel.style.top = "".concat(labelTop, "px");

    // ÂèëÈÄÅÊ∂àÊÅØÂà∞Áà∂Á™óÂè£
    var elementInfo = {
      tagName: target.tagName.toLowerCase(),
      rect: {
        left: rect.left,
        top: rect.top,
        right: rect.right,
        bottom: rect.bottom,
        width: rect.width,
        height: rect.height,
        x: rect.x,
        y: rect.y
      },
      selector: selector,
      text: text,
      attributes: attributes,
      url: window.location.href,
      path: window.location.pathname,
      timestamp: Date.now()
    };
    try {
      window.parent.postMessage({
        type: "iframe-element-hover",
        data: elementInfo,
        source: "iframe-highlight-injector"
      }, "*");
    } catch (error) {
      console.warn("Êó†Ê≥ïÂèëÈÄÅÊ∂àÊÅØÂà∞Áà∂Á™óÂè£:", error);
    }
  }

  // Èº†Ê†áÁ¶ªÂºÄ‰∫ã‰ª∂Â§ÑÁêÜ
  function handleMouseOut(e) {
    if (!highlightEnabled) return;
    var relatedTarget = e.relatedTarget;

    // Â¶ÇÊûúÈº†Ê†áÁßªÂä®Âà∞È´ò‰∫ÆÁõ∏ÂÖ≥ÂÖÉÁ¥†‰∏äÔºå‰∏çÈöêËóèÈ´ò‰∫Æ
    if (relatedTarget && (relatedTarget === highlightBox || relatedTarget === tagLabel || relatedTarget === overlay || relatedTarget === selectedBox || relatedTarget === selectedLabel)) {
      return;
    }
    highlightBox.style.display = "none";
    tagLabel.style.display = "none";
    try {
      window.parent.postMessage({
        type: "iframe-element-hover",
        data: null,
        source: "iframe-highlight-injector"
      }, "*");
    } catch (error) {
      console.warn("Êó†Ê≥ïÂèëÈÄÅÊ∂àÊÅØÂà∞Áà∂Á™óÂè£:", error);
    }
  }

  // ÁÇπÂáª‰∫ã‰ª∂Â§ÑÁêÜ
  function handleClick(e) {
    var target = e.target;
    if (!target || target === overlay || target === highlightBox || target === tagLabel || target === selectedBox || target === selectedLabel) {
      return;
    }

    // ÈÅøÂÖçÂ§ÑÁêÜ html Âíå body ÂÖÉÁ¥†
    if (target === document.documentElement || target === document.body) {
      return;
    }

    // Ê£ÄÊü•ÊòØÂê¶ÊòØ‰∫§‰∫íÂÖÉÁ¥†ÔºåËøô‰∫õÂÖÉÁ¥†ÈúÄË¶Å‰øùÁïôÈªòËÆ§Ë°å‰∏∫
    var isInteractiveElement = ['input', 'textarea', 'select', 'button', 'a'].includes(target.tagName.toLowerCase());

    // Â¶ÇÊûúÈ´ò‰∫ÆÂäüËÉΩÂêØÁî®ÔºåÂØπ‰∫éÈùû‰∫§‰∫íÂÖÉÁ¥†ÈòªÊ≠¢ÈªòËÆ§Ë°å‰∏∫Âíå‰∫ã‰ª∂‰º†Êí≠
    if (highlightEnabled) {
      e.preventDefault();
      e.stopPropagation();
    }
    var rect = target.getBoundingClientRect();
    var selector = getElementSelector(target);
    var text = getElementText(target);
    var attributes = getElementAttributes(target);
    console.log("Element clicked:", {
      tagName: target.tagName,
      selector: selector,
      rect: rect
    });

    // Á´ãÂç≥Êõ¥Êñ∞ÈÄâ‰∏≠È´ò‰∫Æ
    updateSelectedHighlight(target);

    // ÈöêËóèÊÇ¨ÂÅúÈ´ò‰∫ÆÔºåÂõ†‰∏∫Áé∞Âú®ÊòØÈÄâ‰∏≠Áä∂ÊÄÅ
    highlightBox.style.display = "none";
    tagLabel.style.display = "none";
    var elementInfo = {
      tagName: target.tagName.toLowerCase(),
      rect: {
        left: rect.left,
        top: rect.top,
        right: rect.right,
        bottom: rect.bottom,
        width: rect.width,
        height: rect.height,
        x: rect.x,
        y: rect.y
      },
      selector: selector,
      text: text,
      attributes: attributes,
      url: window.location.href,
      path: window.location.pathname,
      timestamp: Date.now()
    };
    try {
      window.parent.postMessage({
        type: "iframe-element-click",
        data: elementInfo,
        source: "iframe-highlight-injector"
      }, "*");
    } catch (error) {
      console.warn("Êó†Ê≥ïÂèëÈÄÅÊ∂àÊÅØÂà∞Áà∂Á™óÂè£:", error);
    }
  }

  // ÁõëÂê¨Êù•Ëá™Áà∂Á™óÂè£ÁöÑÊ∂àÊÅØ
  function handleParentMessage(event) {
    console.log("Received message from parent:", event.data);
    if (event.data.type === "iframe-highlight-toggle") {
      var enabled = event.data.enabled;
      console.log("Highlight toggle:", enabled);
      if (enabled) {
        enableHighlight();
      } else {
        disableHighlight();
      }
    } else if (event.data.type === "enable-iframe-highlight") {
      console.log("Enable iframe highlight");
      enableHighlight();
    } else if (event.data.type === "disable-iframe-highlight") {
      console.log("Disable iframe highlight");
      disableHighlight();
    } else if (event.data.type === "toggle-iframe-highlight") {
      var _enabled = event.data.enabled !== undefined ? event.data.enabled : !highlightEnabled;
      console.log("Toggle iframe highlight to:", _enabled);
      if (_enabled) {
        enableHighlight();
      } else {
        disableHighlight();
      }
    } else if (event.data.type === "update-selected-element") {
      var selector = event.data.selector;
      console.log("Update selected element with selector:", selector);
      if (selector) {
        try {
          var element = document.querySelector(selector);
          console.log("Found element by selector:", element);
          updateSelectedHighlight(element);
        } catch (error) {
          console.warn("Failed to select element:", error);
          updateSelectedHighlight(null);
        }
      } else {
        updateSelectedHighlight(null);
      }
    } else if (event.data.type === "clear-selected-element") {
      console.log("Clear selected element");
      updateSelectedHighlight(null);
    }
  }

  // ÂêØÁî®È´ò‰∫ÆÂäüËÉΩ
  function enableHighlight() {
    console.log("Enabling highlight");
    document.addEventListener("mouseover", handleMouseOver, true);
    document.addEventListener("mouseout", handleMouseOut, true);
    document.addEventListener("click", handleClick, true);
    highlightEnabled = true;
    overlay.style.display = "block";
  }

  // Á¶ÅÁî®È´ò‰∫ÆÂäüËÉΩ
  function disableHighlight() {
    console.log("Disabling highlight");
    highlightEnabled = false;
    // ‰øùÊåÅ‰∫ã‰ª∂ÁõëÂê¨Âô®Ôºå‰ΩÜÈÄöËøá highlightEnabled ÂèòÈáèÊéßÂà∂Ë°å‰∏∫
    // ËøôÊ†∑ÂèØ‰ª•‰øùÁïôÈÄâ‰∏≠Áä∂ÊÄÅÁöÑÊòæÁ§∫
    highlightBox.style.display = "none";
    tagLabel.style.display = "none";
    // ‰∏çÈöêËóè selectedBox Âíå selectedLabelÔºå‰øùÁïôÈÄâ‰∏≠Áä∂ÊÄÅ
  }

  // ÂÆåÂÖ®Á¶ÅÁî®È´ò‰∫ÆÂäüËÉΩÔºàÁßªÈô§ÊâÄÊúâÁõëÂê¨Âô®Ôºâ
  function fullyDisableHighlight() {
    console.log("Fully disabling highlight");
    highlightEnabled = false;
    document.removeEventListener("mouseover", handleMouseOver, true);
    document.removeEventListener("mouseout", handleMouseOut, true);
    document.removeEventListener("click", handleClick, true);
    overlay.style.display = "none";
    highlightBox.style.display = "none";
    tagLabel.style.display = "none";
    selectedBox.style.display = "none";
    selectedLabel.style.display = "none";
  }

  // Ê∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨
  enableHighlight();
  window.addEventListener("message", handleParentMessage);

  // Êö¥Èú≤ÂÖ®Â±ÄÂáΩÊï∞‰æõÂ§ñÈÉ®Ë∞ÉÁî®
  window.__iframeHighlightControl = {
    enable: enableHighlight,
    disable: disableHighlight,
    fullyDisable: fullyDisableHighlight,
    isEnabled: function isEnabled() {
      return highlightEnabled;
    },
    getSelectedElement: function getSelectedElement() {
      return selectedElement;
    },
    updateSelected: updateSelectedHighlight,
    // ÈÄöËøáÊ∂àÊÅØÂèëÈÄÅÂºÄÂÖ≥ÊéßÂà∂
    sendToggleMessage: function sendToggleMessage(enabled) {
      window.parent.postMessage({
        type: 'iframe-highlight-status',
        enabled: enabled || highlightEnabled,
        source: 'iframe-highlight-injector'
      }, '*');
    }
  };

  // ÈÄöÁü•Áà∂Á™óÂè£ËÑöÊú¨Â∑≤Âä†ËΩΩ
  try {
    window.parent.postMessage({
      type: "iframe-highlight-ready",
      data: {
        url: window.location.href,
        userAgent: navigator.userAgent,
        timestamp: Date.now()
      },
      source: "iframe-highlight-injector"
    }, "*");
  } catch (error) {
    console.warn("Êó†Ê≥ïÂèëÈÄÅÂ∞±Áª™Ê∂àÊÅØÂà∞Áà∂Á™óÂè£:", error);
  }

  // Ê∏ÖÁêÜÂáΩÊï∞
  window.__iframeHighlightCleanup = function () {
    fullyDisableHighlight();
    window.removeEventListener("message", handleParentMessage);
    if (overlay.parentElement) {
      overlay.parentElement.removeChild(overlay);
    }
    delete window.__iframeHighlightInitialized;
    delete window.__iframeHighlightCleanup;
  };
})();

</script>

<script>
/**
 * Iframe ÂÖÉÁ¥†È´ò‰∫ÆÊ≥®ÂÖ•ËÑöÊú¨
 * ÈúÄË¶ÅÂú®ÁõÆÊ†áÁΩëÁ´ô‰∏≠ÂºïÂÖ•Ê≠§ËÑöÊú¨Êù•ÊîØÊåÅË∑®Âüü iframe È´ò‰∫ÆÂäüËÉΩ
 *
 * ‰ΩøÁî®ÊñπÊ≥ïÔºö
 * 1. Â∞ÜÊ≠§ËÑöÊú¨Ê∑ªÂä†Âà∞ÁõÆÊ†áÁΩëÁ´ôÁöÑ HTML ‰∏≠
 * 2. ÊàñÈÄöËøáÊµèËßàÂô®Êâ©Â±ï„ÄÅÁî®Êà∑ËÑöÊú¨Á≠âÊñπÂºèÊ≥®ÂÖ•
 */

(function () {
  "use strict";

  // Ê£ÄÊü•ÊòØÂê¶Âú® iframe ‰∏≠
  if (window.self === window.top) {
    return; // ‰∏çÂú® iframe ‰∏≠Ôºå‰∏çÊâßË°å
  }

  // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÂàùÂßãÂåñËøá
  if (window.__iframeHighlightInitialized) {
    return;
  }
  window.__iframeHighlightInitialized = true;
  console.log("Iframe È´ò‰∫ÆËÑöÊú¨Â∑≤Âä†ËΩΩ");

  // ÂàõÂª∫È´ò‰∫ÆË¶ÜÁõñÂ±Ç
  var overlay = document.createElement("div");
  overlay.id = "iframe-highlight-overlay";
  overlay.style.cssText = "\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    pointer-events: none;\n    z-index: 999999;\n    overflow: hidden;\n  ";

  // ÂàõÂª∫ÊÇ¨ÂÅúÈ´ò‰∫ÆÊ°ÜÔºàËôöÁ∫øËæπÊ°ÜÔºâ
  var highlightBox = document.createElement("div");
  highlightBox.id = "iframe-highlight-box";
  highlightBox.style.cssText = "\n    position: absolute;\n    border: 2px dashed #007AFF;\n    background: rgba(0, 122, 255, 0.08);\n    pointer-events: none;\n    display: none;\n    transition: all 0.1s ease;\n    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.8);\n    border-radius: 2px;\n  ";

  // ÂàõÂª∫ÈÄâ‰∏≠ËäÇÁÇπÁöÑÂ∏∏È©ªÈ´ò‰∫ÆÊ°ÜÔºàÂÆûÁ∫øËæπÊ°ÜÔºâ
  var selectedBox = document.createElement("div");
  selectedBox.id = "iframe-selected-box";
  selectedBox.style.cssText = "\n    position: absolute;\n    border: 2px solid #007AFF;\n    pointer-events: none;\n    display: none;\n    box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.9), 0 0 8px rgba(255, 107, 53, 0.4);\n    border-radius: 2px;\n    z-index: 1000000;\n  ";

  // ÂàõÂª∫ÊÇ¨ÂÅúÊ†áÁ≠æÊòæÁ§∫
  var tagLabel = document.createElement("div");
  tagLabel.id = "iframe-tag-label";
  tagLabel.style.cssText = "\n    position: absolute;\n    background: #007AFF;\n    color: white;\n    padding: 2px 6px;\n    font-size: 11px;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n    border-radius: 2px;\n    pointer-events: none;\n    display: none;\n    white-space: nowrap;\n    z-index: 1000001;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);\n    font-weight: 500;\n  ";

  // ÂàõÂª∫ÈÄâ‰∏≠ËäÇÁÇπÊ†áÁ≠æ
  var selectedLabel = document.createElement("div");
  selectedLabel.id = "iframe-selected-label";
  selectedLabel.style.cssText = "\n    position: absolute;\n    background: #007AFF;\n    color: white;\n    padding: 3px 8px;\n    font-size: 11px;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n    border-radius: 3px;\n    pointer-events: none;\n    display: none;\n    white-space: nowrap;\n    z-index: 1000002;\n    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);\n    font-weight: 600;\n  ";
  overlay.appendChild(highlightBox);
  overlay.appendChild(selectedBox);
  overlay.appendChild(tagLabel);
  overlay.appendChild(selectedLabel);
  document.body.appendChild(overlay);

  // Â≠òÂÇ®ÂΩìÂâçÈÄâ‰∏≠ÁöÑÂÖÉÁ¥†
  var selectedElement = null;
  var highlightEnabled = false;

  // Êõ¥Êñ∞ÈÄâ‰∏≠ÂÖÉÁ¥†ÁöÑÈ´ò‰∫ÆÊòæÁ§∫
  function updateSelectedHighlight(element) {
    console.log("updateSelectedHighlight called with:", element);
    if (!element) {
      selectedBox.style.display = "none";
      selectedLabel.style.display = "none";
      selectedElement = null;
      console.log("Cleared selected highlight");
      return;
    }
    selectedElement = element;
    var rect = element.getBoundingClientRect();
    console.log("Selected element rect:", rect);

    // Êõ¥Êñ∞ÈÄâ‰∏≠È´ò‰∫ÆÊ°Ü‰ΩçÁΩÆ
    selectedBox.style.display = "block";
    selectedBox.style.left = "".concat(rect.left - 2, "px");
    selectedBox.style.top = "".concat(rect.top - 2, "px");
    selectedBox.style.width = "".concat(rect.width + 4, "px");
    selectedBox.style.height = "".concat(rect.height + 4, "px");

    // Êõ¥Êñ∞ÈÄâ‰∏≠Ê†áÁ≠æ‰ΩçÁΩÆÂíåÂÜÖÂÆπ
    selectedLabel.style.display = "block";
    selectedLabel.textContent = "\u2713 <".concat(element.tagName.toLowerCase(), ">");

    // ËÆ°ÁÆóÊ†áÁ≠æ‰ΩçÁΩÆÔºåÁ°Æ‰øù‰∏çË∂ÖÂá∫ËßÜÁ™ó
    var labelTop = rect.top - 28;
    var labelLeft = rect.left;

    // Â¶ÇÊûúÊ†áÁ≠æ‰ºöË∂ÖÂá∫È°∂ÈÉ®ÔºåÊòæÁ§∫Âú®ÂÖÉÁ¥†‰∏ãÊñπ
    if (labelTop < 5) {
      labelTop = rect.bottom + 5;
    }

    // Â¶ÇÊûúÊ†áÁ≠æ‰ºöË∂ÖÂá∫Âè≥‰æßÔºåÂêëÂ∑¶Ë∞ÉÊï¥
    var labelWidth = selectedLabel.offsetWidth || 100; // È¢Ñ‰º∞ÂÆΩÂ∫¶
    if (labelLeft + labelWidth > window.innerWidth - 10) {
      labelLeft = window.innerWidth - labelWidth - 10;
    }
    selectedLabel.style.left = "".concat(Math.max(5, labelLeft), "px");
    selectedLabel.style.top = "".concat(labelTop, "px");
    console.log("Selected highlight positioned at:", {
      left: selectedBox.style.left,
      top: selectedBox.style.top,
      width: selectedBox.style.width,
      height: selectedBox.style.height
    });
  }
  function getElementSelector(element) {
    if (!(element instanceof Element)) throw new Error('Argument must be a DOM element');
    var segments = [];
    var current = element;
    while (current !== document.documentElement) {
      var selector = '';
      // ‰ºòÂÖàÊ£ÄÊü•ÂîØ‰∏ÄID
      if (current.id && document.querySelectorAll("#".concat(current.id)).length === 1) {
        segments.unshift("#".concat(current.id));
        break; // IDÂîØ‰∏ÄÔºåÊó†ÈúÄÁªßÁª≠Âêë‰∏ä
      }

      // ÁîüÊàêÁ±ªÂêçÈÄâÊã©Âô®ÔºàÂèñÁ¨¨‰∏Ä‰∏™ÊúâÊïàÁ±ªÂêçÔºâ
      var classes = Array.from(current.classList).filter(function (c) {
        return !c.startsWith('js-');
      });
      var className = classes.length > 0 ? ".".concat(classes[0]) : '';

      // ÁîüÊàê‰ΩçÁΩÆÁ¥¢ÂºïÔºànth-childÔºâ
      var tag = current.tagName.toLowerCase();
      if (!className) {
        var siblings = Array.from(current.parentNode.children);
        var index = siblings.findIndex(function (el) {
          return el === current;
        }) + 1;
        selector = "".concat(tag, ":nth-child(").concat(index, ")");
      } else {
        selector = className;
      }
      segments.unshift(selector);
      current = current.parentElement;
    }

    // Â§ÑÁêÜÊ†πÂÖÉÁ¥†
    if (current === document.documentElement) {
      segments.unshift('html');
    }
    return segments.join(' > ');
  }

  // Ëé∑ÂèñÂÖÉÁ¥†ÊñáÊú¨ÂÜÖÂÆπ
  function getElementText(element) {
    var _element$textContent;
    if (element.tagName === "INPUT") {
      return element.value || element.placeholder || "";
    }
    if (element.tagName === "TEXTAREA") {
      return element.value || element.placeholder || "";
    }
    var text = ((_element$textContent = element.textContent) === null || _element$textContent === void 0 ? void 0 : _element$textContent.trim()) || "";
    return text.length > 50 ? text.substring(0, 50) + "..." : text;
  }

  // Ëé∑ÂèñÂÖÉÁ¥†Â±ûÊÄß‰ø°ÊÅØ
  function getElementAttributes(element) {
    var attrs = {};
    for (var i = 0; i < element.attributes.length; i++) {
      var attr = element.attributes[i];
      attrs[attr.name] = attr.value;
    }
    return attrs;
  }

  // Èº†Ê†áÊÇ¨ÂÅú‰∫ã‰ª∂Â§ÑÁêÜ
  function handleMouseOver(e) {
    if (!highlightEnabled) return;
    var target = e.target;
    if (!target || target === overlay || target === highlightBox || target === tagLabel || target === selectedBox || target === selectedLabel) {
      return;
    }

    // ÈÅøÂÖçÈ´ò‰∫Æ html Âíå body ÂÖÉÁ¥†
    if (target === document.documentElement || target === document.body) {
      return;
    }

    // Â¶ÇÊûúÊòØÂ∑≤ÈÄâ‰∏≠ÁöÑÂÖÉÁ¥†Ôºå‰∏çÊòæÁ§∫ÊÇ¨ÂÅúÈ´ò‰∫Æ
    if (target === selectedElement) {
      highlightBox.style.display = "none";
      tagLabel.style.display = "none";
      return;
    }
    var rect = target.getBoundingClientRect();
    var selector = getElementSelector(target);
    var text = getElementText(target);
    var attributes = getElementAttributes(target);

    // Êõ¥Êñ∞ÊÇ¨ÂÅúÈ´ò‰∫ÆÊ°Ü‰ΩçÁΩÆ
    highlightBox.style.display = "block";
    highlightBox.style.left = "".concat(rect.left - 2, "px");
    highlightBox.style.top = "".concat(rect.top - 2, "px");
    highlightBox.style.width = "".concat(rect.width + 4, "px");
    highlightBox.style.height = "".concat(rect.height + 4, "px");

    // Êõ¥Êñ∞Ê†áÁ≠æ‰ΩçÁΩÆÂíåÂÜÖÂÆπ
    tagLabel.style.display = "block";
    tagLabel.textContent = "<".concat(target.tagName.toLowerCase(), ">");

    // ËÆ°ÁÆóÊ†áÁ≠æ‰ΩçÁΩÆÔºåÁ°Æ‰øù‰∏çË∂ÖÂá∫ËßÜÁ™ó
    var labelTop = rect.top - 22;
    var labelLeft = rect.left;

    // Â¶ÇÊûúÊ†áÁ≠æ‰ºöË∂ÖÂá∫È°∂ÈÉ®ÔºåÊòæÁ§∫Âú®ÂÖÉÁ¥†‰∏ãÊñπ
    if (labelTop < 0) {
      labelTop = rect.bottom + 5;
    }

    // Â¶ÇÊûúÊ†áÁ≠æ‰ºöË∂ÖÂá∫Âè≥‰æßÔºåÂêëÂ∑¶Ë∞ÉÊï¥
    if (labelLeft + tagLabel.offsetWidth > window.innerWidth) {
      labelLeft = window.innerWidth - tagLabel.offsetWidth - 5;
    }
    tagLabel.style.left = "".concat(Math.max(0, labelLeft), "px");
    tagLabel.style.top = "".concat(labelTop, "px");

    // ÂèëÈÄÅÊ∂àÊÅØÂà∞Áà∂Á™óÂè£
    var elementInfo = {
      tagName: target.tagName.toLowerCase(),
      rect: {
        left: rect.left,
        top: rect.top,
        right: rect.right,
        bottom: rect.bottom,
        width: rect.width,
        height: rect.height,
        x: rect.x,
        y: rect.y
      },
      selector: selector,
      text: text,
      attributes: attributes,
      url: window.location.href,
      path: window.location.pathname,
      timestamp: Date.now()
    };
    try {
      window.parent.postMessage({
        type: "iframe-element-hover",
        data: elementInfo,
        source: "iframe-highlight-injector"
      }, "*");
    } catch (error) {
      console.warn("Êó†Ê≥ïÂèëÈÄÅÊ∂àÊÅØÂà∞Áà∂Á™óÂè£:", error);
    }
  }

  // Èº†Ê†áÁ¶ªÂºÄ‰∫ã‰ª∂Â§ÑÁêÜ
  function handleMouseOut(e) {
    if (!highlightEnabled) return;
    var relatedTarget = e.relatedTarget;

    // Â¶ÇÊûúÈº†Ê†áÁßªÂä®Âà∞È´ò‰∫ÆÁõ∏ÂÖ≥ÂÖÉÁ¥†‰∏äÔºå‰∏çÈöêËóèÈ´ò‰∫Æ
    if (relatedTarget && (relatedTarget === highlightBox || relatedTarget === tagLabel || relatedTarget === overlay || relatedTarget === selectedBox || relatedTarget === selectedLabel)) {
      return;
    }
    highlightBox.style.display = "none";
    tagLabel.style.display = "none";
    try {
      window.parent.postMessage({
        type: "iframe-element-hover",
        data: null,
        source: "iframe-highlight-injector"
      }, "*");
    } catch (error) {
      console.warn("Êó†Ê≥ïÂèëÈÄÅÊ∂àÊÅØÂà∞Áà∂Á™óÂè£:", error);
    }
  }

  // ÁÇπÂáª‰∫ã‰ª∂Â§ÑÁêÜ
  function handleClick(e) {
    var target = e.target;
    if (!target || target === overlay || target === highlightBox || target === tagLabel || target === selectedBox || target === selectedLabel) {
      return;
    }

    // ÈÅøÂÖçÂ§ÑÁêÜ html Âíå body ÂÖÉÁ¥†
    if (target === document.documentElement || target === document.body) {
      return;
    }

    // Ê£ÄÊü•ÊòØÂê¶ÊòØ‰∫§‰∫íÂÖÉÁ¥†ÔºåËøô‰∫õÂÖÉÁ¥†ÈúÄË¶Å‰øùÁïôÈªòËÆ§Ë°å‰∏∫
    var isInteractiveElement = ['input', 'textarea', 'select', 'button', 'a'].includes(target.tagName.toLowerCase());

    // Â¶ÇÊûúÈ´ò‰∫ÆÂäüËÉΩÂêØÁî®ÔºåÂØπ‰∫éÈùû‰∫§‰∫íÂÖÉÁ¥†ÈòªÊ≠¢ÈªòËÆ§Ë°å‰∏∫Âíå‰∫ã‰ª∂‰º†Êí≠
    if (highlightEnabled) {
      e.preventDefault();
      e.stopPropagation();
    }
    var rect = target.getBoundingClientRect();
    var selector = getElementSelector(target);
    var text = getElementText(target);
    var attributes = getElementAttributes(target);
    console.log("Element clicked:", {
      tagName: target.tagName,
      selector: selector,
      rect: rect
    });

    // Á´ãÂç≥Êõ¥Êñ∞ÈÄâ‰∏≠È´ò‰∫Æ
    updateSelectedHighlight(target);

    // ÈöêËóèÊÇ¨ÂÅúÈ´ò‰∫ÆÔºåÂõ†‰∏∫Áé∞Âú®ÊòØÈÄâ‰∏≠Áä∂ÊÄÅ
    highlightBox.style.display = "none";
    tagLabel.style.display = "none";
    var elementInfo = {
      tagName: target.tagName.toLowerCase(),
      rect: {
        left: rect.left,
        top: rect.top,
        right: rect.right,
        bottom: rect.bottom,
        width: rect.width,
        height: rect.height,
        x: rect.x,
        y: rect.y
      },
      selector: selector,
      text: text,
      attributes: attributes,
      url: window.location.href,
      path: window.location.pathname,
      timestamp: Date.now()
    };
    try {
      window.parent.postMessage({
        type: "iframe-element-click",
        data: elementInfo,
        source: "iframe-highlight-injector"
      }, "*");
    } catch (error) {
      console.warn("Êó†Ê≥ïÂèëÈÄÅÊ∂àÊÅØÂà∞Áà∂Á™óÂè£:", error);
    }
  }

  // ÁõëÂê¨Êù•Ëá™Áà∂Á™óÂè£ÁöÑÊ∂àÊÅØ
  function handleParentMessage(event) {
    console.log("Received message from parent:", event.data);
    if (event.data.type === "iframe-highlight-toggle") {
      var enabled = event.data.enabled;
      console.log("Highlight toggle:", enabled);
      if (enabled) {
        enableHighlight();
      } else {
        disableHighlight();
      }
    } else if (event.data.type === "enable-iframe-highlight") {
      console.log("Enable iframe highlight");
      enableHighlight();
    } else if (event.data.type === "disable-iframe-highlight") {
      console.log("Disable iframe highlight");
      disableHighlight();
    } else if (event.data.type === "toggle-iframe-highlight") {
      var _enabled = event.data.enabled !== undefined ? event.data.enabled : !highlightEnabled;
      console.log("Toggle iframe highlight to:", _enabled);
      if (_enabled) {
        enableHighlight();
      } else {
        disableHighlight();
      }
    } else if (event.data.type === "update-selected-element") {
      var selector = event.data.selector;
      console.log("Update selected element with selector:", selector);
      if (selector) {
        try {
          var element = document.querySelector(selector);
          console.log("Found element by selector:", element);
          updateSelectedHighlight(element);
        } catch (error) {
          console.warn("Failed to select element:", error);
          updateSelectedHighlight(null);
        }
      } else {
        updateSelectedHighlight(null);
      }
    } else if (event.data.type === "clear-selected-element") {
      console.log("Clear selected element");
      updateSelectedHighlight(null);
    }
  }

  // ÂêØÁî®È´ò‰∫ÆÂäüËÉΩ
  function enableHighlight() {
    console.log("Enabling highlight");
    document.addEventListener("mouseover", handleMouseOver, true);
    document.addEventListener("mouseout", handleMouseOut, true);
    document.addEventListener("click", handleClick, true);
    highlightEnabled = true;
    overlay.style.display = "block";
  }

  // Á¶ÅÁî®È´ò‰∫ÆÂäüËÉΩ
  function disableHighlight() {
    console.log("Disabling highlight");
    highlightEnabled = false;
    // ‰øùÊåÅ‰∫ã‰ª∂ÁõëÂê¨Âô®Ôºå‰ΩÜÈÄöËøá highlightEnabled ÂèòÈáèÊéßÂà∂Ë°å‰∏∫
    // ËøôÊ†∑ÂèØ‰ª•‰øùÁïôÈÄâ‰∏≠Áä∂ÊÄÅÁöÑÊòæÁ§∫
    highlightBox.style.display = "none";
    tagLabel.style.display = "none";
    // ‰∏çÈöêËóè selectedBox Âíå selectedLabelÔºå‰øùÁïôÈÄâ‰∏≠Áä∂ÊÄÅ
  }

  // ÂÆåÂÖ®Á¶ÅÁî®È´ò‰∫ÆÂäüËÉΩÔºàÁßªÈô§ÊâÄÊúâÁõëÂê¨Âô®Ôºâ
  function fullyDisableHighlight() {
    console.log("Fully disabling highlight");
    highlightEnabled = false;
    document.removeEventListener("mouseover", handleMouseOver, true);
    document.removeEventListener("mouseout", handleMouseOut, true);
    document.removeEventListener("click", handleClick, true);
    overlay.style.display = "none";
    highlightBox.style.display = "none";
    tagLabel.style.display = "none";
    selectedBox.style.display = "none";
    selectedLabel.style.display = "none";
  }

  // Ê∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨
  enableHighlight();
  window.addEventListener("message", handleParentMessage);

  // Êö¥Èú≤ÂÖ®Â±ÄÂáΩÊï∞‰æõÂ§ñÈÉ®Ë∞ÉÁî®
  window.__iframeHighlightControl = {
    enable: enableHighlight,
    disable: disableHighlight,
    fullyDisable: fullyDisableHighlight,
    isEnabled: function isEnabled() {
      return highlightEnabled;
    },
    getSelectedElement: function getSelectedElement() {
      return selectedElement;
    },
    updateSelected: updateSelectedHighlight,
    // ÈÄöËøáÊ∂àÊÅØÂèëÈÄÅÂºÄÂÖ≥ÊéßÂà∂
    sendToggleMessage: function sendToggleMessage(enabled) {
      window.parent.postMessage({
        type: 'iframe-highlight-status',
        enabled: enabled || highlightEnabled,
        source: 'iframe-highlight-injector'
      }, '*');
    }
  };

  // ÈÄöÁü•Áà∂Á™óÂè£ËÑöÊú¨Â∑≤Âä†ËΩΩ
  try {
    window.parent.postMessage({
      type: "iframe-highlight-ready",
      data: {
        url: window.location.href,
        userAgent: navigator.userAgent,
        timestamp: Date.now()
      },
      source: "iframe-highlight-injector"
    }, "*");
  } catch (error) {
    console.warn("Êó†Ê≥ïÂèëÈÄÅÂ∞±Áª™Ê∂àÊÅØÂà∞Áà∂Á™óÂè£:", error);
  }

  // Ê∏ÖÁêÜÂáΩÊï∞
  window.__iframeHighlightCleanup = function () {
    fullyDisableHighlight();
    window.removeEventListener("message", handleParentMessage);
    if (overlay.parentElement) {
      overlay.parentElement.removeChild(overlay);
    }
    delete window.__iframeHighlightInitialized;
    delete window.__iframeHighlightCleanup;
  };
})();

</script>
</body>
</html>
